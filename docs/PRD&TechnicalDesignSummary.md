# 产品设计文档

## 项目名称：Minecraft MCP 平台（mc-mcp-platform）

---

## 1. 项目背景与目标

随着大模型能力逐步成熟，单纯基于文本上下文的模型已难以满足复杂系统的交互与治理需求。Minecraft 作为一个高度复杂、实时变化、规则密集的虚拟世界，非常适合作为 MCP（Model Context Protocol）应用的典型场景。然而当前缺乏一个标准化、可扩展、可治理的 MCP 接入层，使模型无法安全、可靠地理解并操作真实运行的 Minecraft 世界。

本项目旨在构建一个面向 Minecraft 服务端生态的 MCP 平台，使任意模型能够通过标准化协议安全地获取世界上下文并执行受控操作，同时为服务器管理员提供审计、审批、回滚、风控与策略治理能力。

---

## 2. 产品定位

本项目定位为：

> **Minecraft 服务端 MCP 能力适配与治理平台。**

该平台由两大核心子系统组成：

1. **Model Context Protocol Agent**：Minecraft 服务端插件，作为 MCP 能力提供与执行终端。
2. **Minecraft MCP Gateway**：前后端一体的 Web 平台，作为 MCP 协议对接、治理中枢与人机协作界面。

---

## 3. 目标用户与使用场景

### 3.1 目标用户

* Minecraft 服务器管理员 / 运维人员
* Minecraft 插件开发者
* AI 应用开发者 / 自动化系统设计者
* 教育服、剧情服、RPG 服、社区服等服务器运营团队

### 3.2 核心使用场景

* AI 管理员协助服务器治理、违规检测、性能调优
* 模型自动生成活动、任务、剧情并安全落地到世界
* 自动化运维系统根据目标指标动态调整服务器参数
* 多服务器统一治理、审计与控制

---

## 4. 产品整体架构

### 4.1 系统构成

项目由三个逻辑构件组成：

1. **Model Context Protocol Agent（服务端插件）**
2. **Minecraft MCP Gateway（Web 控制平台）**
3. **MCP 能力规范与协议层（Contract Layer）**

---

### 4.2 架构分层图（逻辑）

```
+----------------------------+
|        Model Clients       |
| (LLMs, Bots, Tools, UIs)   |
+--------------+-------------+
               |
               v
+----------------------------+
|     Minecraft MCP Gateway  |
|----------------------------|
| - MCP Protocol Adapter     |
| - Auth / RBAC / Risk       |
| - Audit / Approval / Rollback |
| - Strategy & Orchestration |
| - Web Console UI           |
+--------------+-------------+
               |
               v
+----------------------------+
|   MCP Agent (Server Plugin)|
|----------------------------|
| - Provider SDK             |
| - Core MCP Capabilities    |
| - Execution Engine         |
| - Safety & Snapshot Hooks  |
+--------------+-------------+
               |
               v
+----------------------------+
|     Minecraft Server       |
+----------------------------+
```

---

## 5. 子项目一：Model Context Protocol Agent（插件侧）

### 5.1 产品目标

* 提供标准 MCP 能力执行环境；
* 提供 Java SDK 使其他插件能以代码方式定义 MCP 接口；
* 实现基础世界、玩家、经济、系统等核心 MCP 能力；
* 与 MCP Gateway 进行安全、可靠、可审计的通信。

---

### 5.2 核心模块设计

#### 5.2.1 Provider SDK 层

* 提供注解与注册机制：

  * `@McpProvider`
  * `@McpContext`
  * `@McpAction`
  * `@McpEvent`
* 自动生成能力清单与参数 Schema；
* 自动完成能力注册、路由绑定、错误封装。

#### 5.2.2 Core Capability 层（内置能力）

* 世界上下文：

  * 时间、天气、难度、规则、TPS、区块负载
* 玩家上下文：

  * 在线状态、位置、背包、权限组、经济余额
* 世界操作：

  * 设置规则、清理实体、传送、天气控制
* 玩家操作：

  * Kick、Mute、Warn、Teleport、Ban（可选）
* 系统操作：

  * 世界备份、恢复、重载插件

#### 5.2.3 执行与安全层

* 权限校验（插件侧二次校验）
* 风险等级标注
* 自动快照与回滚钩子
* 审计事件生成

#### 5.2.4 通信适配层

* 提供 WebSocket 服务端接口；
* 与 Gateway 的注册、心跳、调用、事件推送。

---

## 6. 子项目二：Minecraft MCP Gateway（Web 平台）

### 6.1 产品目标

* 实现 MCP 协议对接与模型通信；
* 提供统一权限控制、风控、审批、审计、回滚机制；
* 管理多个 MCP Agent 实例；
* 提供 Web 控制台进行配置、监控、治理与调试；
* 提供策略执行与目标驱动自动化能力（规则引擎）。

---

### 6.2 核心模块设计

#### 6.2.1 MCP 协议适配模块

* MCP Context / Tools 接口实现；
* 能力发现与声明解析；
* 能力路由与执行调度。

#### 6.2.2 权限与风控模块

* RBAC 权限模型；
* 风险等级与策略规则；
* 审批流引擎；
* 模型操作限额与频控。

#### 6.2.3 审计、审批与回滚模块

* 全量操作审计日志；
* 高风险操作审批队列；
* 快照管理与回滚执行；
* 审计回放与导出。

#### 6.2.4 策略与编排模块（规则引擎）

* 支持目标驱动策略定义；
* 支持 If-Then 编排规则；
* 支持周期性巡检与调节；
* 支持模型辅助生成策略。

#### 6.2.5 多服务器管理模块

* Server Registry（Agent 注册与管理）
* 多环境支持（测试 / 预发 / 生产）

#### 6.2.6 Web 控制台

* 能力浏览与测试工具
* 审批与审计界面
* 策略配置界面
* Agent 健康监控界面

---

## 7. MCP 能力规范层（Contract Layer）

### 7.1 规范内容

* 能力命名规范（如 `economy.adjustBalance`）
* 参数与返回值 JSON Schema 标准
* 错误码与异常结构
* 能力版本管理与弃用规则
* Provider 注册协议

### 7.2 设计目标

* 实现 Agent 与 Gateway 解耦；
* 支持第三方实现 MCP Provider；
* 支持能力生态演进。

---

## 8. 权限模型与风控体系

### 8.1 角色模型

| 角色          | 权限级别  | 描述            |
| ----------- | ----- | ------------- |
| Viewer      | 只读    | 仅可读取上下文       |
| Operator    | 低风险执行 | 可执行玩家级操作      |
| Admin       | 高风险执行 | 可执行世界/经济/系统操作 |
| Super Admin | 全权限   | 可配置策略与权限模型    |

---

### 8.2 风险分级

| 操作类型    | 风险级别     | 默认策略 |
| ------- | -------- | ---- |
| 上下文查询   | Low      | 自动允许 |
| 玩家操作    | Medium   | 自动允许 |
| 世界/经济修改 | High     | 需审批  |
| 回滚/恢复   | Critical | 多重审批 |

---

### 8.3 审计与回滚

* 所有操作必须写入审计日志；
* 支持世界、经济、玩家状态回滚；
* 支持回滚前自动快照。

---

## 9. 技术选型建议

### 9.1 Agent（插件）

* 语言：Java
* 平台：Paper / Spigot API
* 通信：WebSocket
* 序列化：JSON（可后期升级 Protobuf）

### 9.2 Gateway（平台）

* 后端：Python（FastAPI）
* 前端：Vue
* 数据库：PostgreSQL
* 审计存储：PostgreSQL

---

## 10. MVP 功能范围（Phase 1）

### Agent MVP

* Java SDK 能力声明机制
* 世界、玩家、系统基础上下文
* 玩家治理操作（Kick、Mute、Teleport）
* 世界清实体、规则修改
* 世界备份与恢复
* 与 Gateway 通信模块

**NOTE**: Safety Layer（限流、快照、回滚、风险评估）已跳过，由 Gateway 统一保障安全

### Gateway MVP

* MCP 协议对接
* Agent 注册与能力发现
* RBAC 权限系统
* 审计日志系统
* 高风险操作审批流
* Web 控制台基础页面
* 单服务器支持（多服务器为 Phase 2）

---

## 11. 里程碑与实施计划

### Phase 1（基础可运行平台）

* 完成 Agent 核心插件 + SDK
* 完成 Gateway MCP 对接 + 权限 + 审计
* 打通模型 → Gateway → Agent → Minecraft 执行链路
* **NOTE**: Safety Layer 跳过，由 Gateway 保障安全

### Phase 2（平台化能力）

* 多服务器管理
* 策略引擎与目标控制
* 插件生态接入文档与示例

### Phase 3（自治与智能化）

* 目标驱动自治系统
* 自动异常修复
* 高级剧情生成与内容自动化

---

## 12. 成功标准（KPI）

* 插件开发者能在 ≤ 30 分钟内接入 MCP 能力；
* 模型操作错误率 < 1%；
* 高风险操作 100% 可审计、可回滚；
* 系统支持多服务器治理且无跨服权限泄漏；
* MCP 能力标准可被第三方实现。

---

## 13. 结论

本项目具备以下核心优势：

* 明确的能力分层与责任边界；
* 高度标准化的插件接入模型；
* 强治理能力与安全性设计；
* 面向未来 AI 自治系统的可扩展架构。

这是一个具备长期生态价值与平台潜力的基础设施型项目。

---

如果你需要，我可以下一步为你输出：

* 架构图的 UML / Mermaid 版本；
* 功能模块拆解表（JIRA / Roadmap 格式）；
* 接口文档模板（OpenAPI / MCP Capability JSON）；
* 投标/立项版商业说明书。
